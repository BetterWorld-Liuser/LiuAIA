var gt=Object.defineProperty;var vt=(n,t,e)=>t in n?gt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var N=(n,t,e)=>(vt(n,typeof t!="symbol"?t+"":t,e),e);import{S as ft,i as ht,s as mt,k as h,l as p,m as _,h as u,n as d,b as G,B as tt,o as _t,L as yt,w as wt,a as S,e as rt,x as bt,c as $,y as Tt,f as Et,t as At,z as Dt,M as j,q as M,N as ct,r as k,p as C,F as l,O as ut,P as q,u as dt,Q as Pt}from"../../chunks/index-f8d20cdf.js";import{_ as Lt}from"../../chunks/preload-helper-9b728935.js";import{w as Nt}from"../../chunks/index-a3f8da71.js";const O=Nt();class Mt{constructor(t,e){N(this,"Amap");N(this,"map");N(this,"locationText");N(this,"_roadNet");N(this,"mouseTool");N(this,"geocoder");this.Amap=t,this.map=e,this.locationText="",this.mouseTool=new t.MouseTool(this.map),this.mouseTool.graphics=[],this.mouseTool.drawState=!1,this.geocoder=new t.Geocoder({city:"\u5168\u56FD"}),this.mouseTool.on("draw",o=>{console.log("\u7ED8\u56FE\u7ED3\u675F"),console.log(o),this.mouseTool.graphics.push(o.obj)})}get district(){return new this.Amap.DistrictSearch({extensions:"all",level:"district"})}get roadNet(){return this._roadNet==null?(this._roadNet=new this.Amap.TileLayer.RoadNet,this._roadNet):this._roadNet}set location(t){this.jumpToLocation(t)}get location(){return[this.map.getCenter().lng,this.map.getCenter().lat]}districtSearch(t){return console.log("\u6B63\u5728\u641C\u7D22:"+t),new Promise((e,o)=>{this.district.search(t,(r,s)=>{s.info=="OK"?e(s):o("\u8BF7\u6C42\u5931\u8D25")})})}laydistrict(t){if(t==null)return;const e=t.districtList[0].boundaries;this.location=[t.districtList[0].center.lng,t.districtList[0].center.lat];const o=[];if(e)for(let r=0,s=e.length;r<s;r++){const i=new this.Amap.Polygon({strokeWeight:1,path:e[r],fillOpacity:.4,fillColor:"#80d8ff",strokeColor:"#0091ea"});o.push(i)}this.add(o)}add(t){this.map.add(t)}startPolygon(t="measureArea"){this.mouseTool.drawState=!0,this.mouseTool[t]({fillColor:"#00b0ff",strokeColor:"#80d8ff"})}closePolygon(t){this.mouseTool.close(t)}cleanPolygon(){this.mouseTool.close(!0),this.mouseTool.graphics=[],this.mouseTool.drawState=!1}jumpToLocation(t){this.map.setCenter(t,!1)}clearMap(){this.map.clearMap()}getLocationText(){return new Promise(t=>{this.geocoder.getAddress(this.location,(e,o)=>{e==="complete"&&o.regeocode?(console.log(o),this.locationText=o.regeocode.formattedAddress,t(this.locationText)):console.error("\u6839\u636E\u7ECF\u7EAC\u5EA6\u67E5\u8BE2\u5730\u5740\u5931\u8D25")})})}}function kt(n){let t;return{c(){t=h("div"),this.h()},l(e){t=p(e,"DIV",{class:!0}),_(t).forEach(u),this.h()},h(){d(t,"class","container svelte-1c3rqzg")},m(e,o){G(e,t,o),n[1](t)},p:tt,i:tt,o:tt,d(e){e&&u(t),n[1](null)}}}let Ct="e5acdc2ffb967abcdef36c5c605341d3";function St(n,t,e){let o,r,s=[118.84,31.95];async function i(){let c=await Lt(()=>import("../../chunks/index-108bff47.js").then(D=>D.i),[],import.meta.url);window._AMapSecurityConfig={securityJsCode:Ct};let f=await c.load({key:"503820a8a61cff6d396d3f3b82f6dc6b",version:"2.0",plugins:["AMap.Scale","AMap.DistrictSearch","AMap.MouseTool","AMap.Geocoder"]}),A=new f.Map(o,{zoom:15,center:s,layers:[new f.TileLayer.Satellite]});return{Amap:f,map:A}}_t(async()=>{let{Amap:c,map:f}=await i();r=new Mt(c,f),O.set(r)});function a(c){yt[c?"unshift":"push"](()=>{o=c,e(0,o)})}return[o,a]}class $t extends ft{constructor(t){super(),ht(this,t,St,kt,mt,{})}}function pt(n){let t,e,o,r,s,i=`\u7ECF\u5EA6${n[1][0].toFixed(2)},\u7EAC\u5EA6:${n[1][1].toFixed(2)}`,a,c,f,A,D,P,L,B,v,w,F,z,b,R,I,x,J,T,K,y,Q,E,W,H,et;return{c(){t=h("div"),e=h("div"),o=h("p"),r=h("span"),s=M("\u5F53\u524D\u5750\u6807\u4E3A:"),a=M(i),c=S(),f=h("p"),A=M("\u5F53\u524D\u4F4D\u7F6E\u4E3A:"),D=S(),P=h("p"),L=M(n[3]),B=S(),v=h("div"),w=h("div"),F=h("label"),z=M("\u9762\u79EF\u6D4B\u91CF"),b=ct("input","ui-switch"),R=S(),I=h("div"),x=h("label"),J=M("\u9053\u8DEF\u89C6\u56FE"),T=ct("input","ui-switch"),K=S(),y=h("input"),Q=S(),E=h("button"),W=M("\u5B9A\u4F4D"),this.h()},l(g){t=p(g,"DIV",{id:!0,class:!0});var m=_(t);e=p(m,"DIV",{});var V=_(e);o=p(V,"P",{});var X=_(o);r=p(X,"SPAN",{style:!0});var ot=_(r);s=k(ot,"\u5F53\u524D\u5750\u6807\u4E3A:"),ot.forEach(u),a=k(X,i),X.forEach(u),c=$(V),f=p(V,"P",{style:!0});var st=_(f);A=k(st,"\u5F53\u524D\u4F4D\u7F6E\u4E3A:"),st.forEach(u),D=$(V),P=p(V,"P",{});var at=_(P);L=k(at,n[3]),at.forEach(u),V.forEach(u),B=$(m),v=p(m,"DIV",{class:!0});var U=_(v);w=p(U,"DIV",{style:!0});var Y=_(w);F=p(Y,"LABEL",{for:!0});var it=_(F);z=k(it,"\u9762\u79EF\u6D4B\u91CF"),it.forEach(u),b=p(Y,"INPUT",{style:!0,type:!0,id:!0,is:!0}),Y.forEach(u),R=$(U),I=p(U,"DIV",{});var Z=_(I);x=p(Z,"LABEL",{for:!0});var lt=_(x);J=k(lt,"\u9053\u8DEF\u89C6\u56FE"),lt.forEach(u),T=p(Z,"INPUT",{style:!0,type:!0,id:!0,is:!0}),Z.forEach(u),U.forEach(u),K=$(m),y=p(m,"INPUT",{class:!0,placeholder:!0}),Q=$(m),E=p(m,"BUTTON",{type:!0,class:!0});var nt=_(E);W=k(nt,"\u5B9A\u4F4D"),nt.forEach(u),m.forEach(u),this.h()},h(){C(r,"font-weight","bold"),C(f,"font-weight","bold"),C(f,"margin-top","10px"),d(F,"for","switch1"),C(b,"margin-left","10px"),d(b,"type","checkbox"),d(b,"id","switch1"),d(b,"is","ui-switch"),C(w,"display","flex"),C(w,"align-items","center"),d(x,"for","switch2"),C(T,"margin-left","10px"),d(T,"type","checkbox"),d(T,"id","switch2"),d(T,"is","ui-switch"),d(v,"class","buttonList svelte-ubhflv"),d(y,"class","ui-input"),d(y,"placeholder","\u6C5F\u5B81\u533A"),d(E,"type","primary"),d(E,"class","ui-button"),d(t,"id","board"),d(t,"class","svelte-ubhflv")},m(g,m){G(g,t,m),l(t,e),l(e,o),l(o,r),l(r,s),l(o,a),l(e,c),l(e,f),l(f,A),l(e,D),l(e,P),l(P,L),l(t,B),l(t,v),l(v,w),l(w,F),l(F,z),l(w,b),l(v,R),l(v,I),l(I,x),l(x,J),l(I,T),l(t,K),l(t,y),ut(y,n[0]),l(t,Q),l(t,E),l(E,W),H||(et=[q(b,"change",n[6]),q(T,"input",n[5]),q(y,"input",n[7]),q(E,"click",n[4])],H=!0)},p(g,m){m&2&&i!==(i=`\u7ECF\u5EA6${g[1][0].toFixed(2)},\u7EAC\u5EA6:${g[1][1].toFixed(2)}`)&&dt(a,i),m&8&&dt(L,g[3]),m&1&&y.value!==g[0]&&ut(y,g[0])},d(g){g&&u(t),H=!1,Pt(et)}}}function Ft(n){let t,e,o,r,s;e=new $t({});let i=n[2]==!0&&pt(n);return{c(){t=h("div"),wt(e.$$.fragment),o=S(),i&&i.c(),r=rt(),this.h()},l(a){t=p(a,"DIV",{id:!0,class:!0});var c=_(t);bt(e.$$.fragment,c),c.forEach(u),o=$(a),i&&i.l(a),r=rt(),this.h()},h(){d(t,"id","map"),d(t,"class","svelte-ubhflv")},m(a,c){G(a,t,c),Tt(e,t,null),G(a,o,c),i&&i.m(a,c),G(a,r,c),s=!0},p(a,[c]){a[2]==!0?i?i.p(a,c):(i=pt(a),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},i(a){s||(Et(e.$$.fragment,a),s=!0)},o(a){At(e.$$.fragment,a),s=!1},d(a){a&&u(t),Dt(e),a&&u(o),i&&i.d(a),a&&u(r)}}}function It(n,t,e){let o="\u6C5F\u5B81\u533A",r=[0,0],s=j(O),i=!1,a="";async function c(){s=j(O),s==null?setTimeout(async()=>{await c()},1e3):(e(2,i=!0),await f())}async function f(){s!=null&&(s.map.on("mousemove",()=>{e(1,r=s.location)}),await L())}async function A(){s.clearMap(),s.laydistrict(await s.districtSearch(o)),setTimeout(async()=>{await L()},1e3)}function D(v){v.target.checked==!0?s.add(s.roadNet):s.map.remove(s.roadNet)}function P(){s.mouseTool.drawState==!0?(s.cleanPolygon(),s=j(O)):(new Dialog().alert("\u5355\u6B21\u70B9\u51FB\u5728\u56FE\u4E2D\u6807\u8BB0\u70B9, \u53CC\u51FB\u7ED3\u675F\u7ED8\u5236!",{title:"\u63D0\u9192",type:"custom",height:"stretch"}),s.startPolygon(),s=j(O))}_t(async()=>{await c()});async function L(){e(3,a=await s.getLocationText())}function B(){o=this.value,e(0,o)}return[o,r,i,a,A,D,P,B]}class Gt extends ft{constructor(t){super(),ht(this,t,It,Ft,mt,{})}}export{Gt as default};
